# 네트워크 공격 탐지 성능향상을 위한 딥러닝을 이용한 트래픽 데이터 생성 연구  
이우호 ‖ 전남대학교 정보보안협동과정  
함재균 ‖ 한국과학기술정보연구원 슈퍼컴퓨팅본부  
정현미 ‖ 한국과학기술정보연구원 슈퍼컴퓨팅본부  
정기문 ‖ 한국과학기술정보연구원 슈퍼컴퓨팅본부  
💼📜

  
- 본 논문에서는 딥러닝 기술중의 하나인 seqGAN을이용하여 침입탐지 연구를 위해 사용되는 데이터셋의 불균형 문제를 해결하고자 한다.  
- 이를 위해서 pcap 형태로 되어있는 네트워크 원본 데이터셋에서 분석하고자 하는 데이터를 추출하여 seqGAN에 입력할 수 있는 형태로 변환하는 것이 과정이 필요하다.

__우선 데이터를 전처리하는 과정은,__  
  - 먼저 Raw packet 데이터는 scapy 프로그램을 이용하여 패킷의 양방향 IP, service protocol, payload 데이터를 추출한 후 vector형태의 인코딩 단계를 거친다.  
  - 추출된 payload는 word 특성을 갖기에 word embedding방법을 사용하여 인코딩한다.  
  - 이와 같은 방법은 자연언어 처리 분야에서는 전반적인 성능 향상을 위해 사용한다.  
------
- 특징(feature)중 숫자 유형을 가진 데이터의 경우 __tanh를 이용하여 –0.99에서 0.99의 범위 값으로 변환__ 하게 된다.  
  - __이는 연산의 결과가 0이 나올 경우 최적화 과정에서 over fitting 문제가 발생할 수 있기 때문__ 이며, 0의 값이 나오지 않도록 clip을 지정한다.
- 두 번째 service protocol 특징의 경우 범주 유형의 데이터 특성을 가지고 있다.  
  - 범주형 데이터의 경우 일반적인 자연어에 비해 크기가 작으므로 soft max를 이용하여 처리한다.  
  - 그리고 __one hot encoding__ 을 이용하여 vector를 생성할 경우 0이 발생할 수 있으므로 __noise값을 넣어 정규화를 한다.__
- 세 번째 payload와 같은 긴 문자열 데이터의 경우 word-gram을 이용한 후, Gumbel-softmax을 이용하여 분포를 정리한다.  
  - encoding 단계에서 먼저 payload를 word로 분리한 다음 각 word embedding을 통해 vector로 변환한다.  
  - payload에 많이 포함된 단어(user name, paswword, control) 등은 word embedding 과정에 노이즈가 유입되는 경우를 고려했다.  
  - 또한 잡음의 영향을 없애기 위해 word embedding mapping을 수행하기 전에 payload를 필터링 한다.  
  - 먼저 학습 데이터 셋에서 다양한 word frequency를 계산한 다음 high frequency word를 기반으로 사전을 생성하여 payload를 필터링한다.  
  - 이러한 전처리를 단계를 거친 데이터는 각 트래픽 별로 vector화 된다.
  
- __max pooling층은 특징의 중 가장 높은 점수를 가진 특징은 보존하고 낮은 점수를 얻은 특징은 삭제한다.__   
  - 이 층은 알고리즘의 noise의 영향을 줄이고 일반화하는 능력을 향상시킨다.  
- __학습 단계에서 soft max 계층은 예측된 값과 실제 값 사이의 loss를 계산하고 네트워크의 가중치를 loss값을 이용하여 조정한다.__   
  - test 단계에서 soft max 계층의 예측된 class의 확률을 출력한다.  
------
- 제안된 방법으로 생성된 데이터가 포함된 데이터셋을 이용할 경우 NSL-KDD 데이터 셋에서 Precision은 약 8%, Recall은 약 5%, F1-score는 약 7%, Accuracy 약 8%의 성능이 향상됨을 확인할 수 있었다.
  
- 제안하는 방법은 네트워크 트래픽 pcap 파일에 대하여 DPI 기반 분석을 위해 IP, Service protocol, payload를 기준으로 하여 특성을 추출하여 분류를 하였다. 
- 또한 데이터 생성에 대한 효율성을 유지하기 위해 충분한 정보를 유지하는 데이터 전처리 방법을 설계했다.
- 제안하는 방법을 통해 기존의 데이터 셋의 유사트래픽을 추가하여 데이터 불균형 문제를 감소함으로써 정밀성을 향상시키기 위한 실험을 진행하였다.
  - 실험결과 공격 트래픽의 희소성이 높을수록 정밀성이 평균 7% 정도 개선되는 것을 확인 할 수 있었다. 
  - 본 접근 방법을 통해 기존의 딥러닝을 이용한 침입탐지시스템의 한계점인 데이터 불균형으로 인한 오탐율 개선에 기여할 수 있을 것으로 보인다.
