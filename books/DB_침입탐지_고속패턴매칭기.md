# 네트워크 침입 탐지 시스템에서 고속 패턴 매칭기의 설계 및 구현
  
윤여찬 ‖ 한국통신학회   
황선영 ‖ 한국통신학회   
💼📜  
  

- 네트워크 침입 시도나 공격은 패턴이나 서브패턴의 조합으로 표현될 수 있다  
  - 패턴 매칭은 네트워크 침입 탐지 시스템에서의 가장 중요한 이슈이다   
  - 사용하는 패턴 매칭 알고리듬에 따라 네트워크 침입 탐지 시스템의 성능이 결정된다  
    - 현재 네트워크 침입 탐지 시스템의 패턴 데이터베이스에는 수천개의 패턴들이 등록되어 있으며, 
    - 패턴의 수는 더욱 늘어날 전망이므로,  
    - 패턴 매칭에서의 병목 현상이 더욱 심해질 것으로 예상된다  
  - 그러나 Snort나 OSSEC와 같은 침입 탐지 시스템들은 대부분 소프트웨어 기반의 패턴 매칭만을 지원한다   
    - 네트워크의 속도가 빨라지면 모든 패킷을 검사하지 못하는 현상이 발생하게 된다  
  - 소프트웨어기반 침입 탐지 시스템의 성능 향상을 위한 연구  
    - 패턴/스트링 매칭 알고리듬의 개선  
    - 다중 컴퓨터를 사용한 Load Balancing  
    - 트래픽 센서 앞단에 Splitter를 사용  
  
## 네트워크 침입 탐지 시스템에서 패턴 매칭  
- 트리구조, 트라이(trie) 구조, 해시 구조, 해시와 트리를 조합한 구조, 상태천이 그래프(statetransition graph)를 이용한 구조 등이 사용된다  
  - 네트워크 시스템에서 패턴 매칭을 하기 위해 필드 포지션(field position)이 정해진 필드 값의 추출, 필드 포지션에 상관없는 필드 값의 추출, 필드값의 비교, 필드 값의 범위 비교, 필드의 일부 값 생략 후 비교, 다수 조건들이 조합된 비교 방법이 주로 사용된다  
  - 하드웨어로 구현하는 패턴 매칭기의 경우 많은 설계 제약조건이 있어 주로 프로세서로 패턴 매칭을 수행하거나, 해시 구조, 해시와 트리를 조합한 구조, 멀티웨이 트리(multi-way tree) 구조들을 이용한 구조들이 발표되었다  
  - 속도를 높이기 위하여 다수의 패턴 매칭기들을 직렬 또는 병렬로 다단 연결하여 수행할 수 있다  
  - 분류 자료들을 다수로 나눈 후 나누어진 분류 자료들을 이용하여 수행하는 구조들이 발표되었다  
- 트리 또는 트라이(trie)를 이용한 분류 및 검색 구조
  - 사전의 검색, 그래픽 에디터, 정지 영상 및 동영상의 압축 등에 자주 사용된다   
  - 트라이 구조는 사전의 단어 검색에 주로 사용되며, 주어진 분류 자료를 포함하는 가장 근사한 엔트리를 찾을 수 있다는 장점이 있다  
  - Quad-tree, Octree 등의 멀티웨이 트리(multi-way tree)구조  
    - 값의 비교(greater than, less than), 값의 범위 비교, 가장 근사한 분류자료의 선택 등의 기능을 수행할 수 있는 장점  
    - 복잡한 조합 규칙을 사용하는 분류는 수행하지 못하는 단점 

## 해시와 트리를 조합한 다단 검색 구조
- 검색 속도를 높이기 위하여 다양한 검색 구조들을 동시에 액세스하는 방법과 분류 자료들을 분할한 후 다수의 검색 구조들을 이용하여 순차적으로 검색하는 검색 구조들을 사용할 수 있다   
- 외부 해시 구조에서 다수의 해시표 엔트리들을 동시에 비교후 삽입 및 검색을 하는 방법을 사용할 수 있다  
- 해시와 트리를 조합하여 분류를 하는 구조  
  - 기존 해시 구조의 충돌현상을 해결하고, 면적을 보다 효율적으로 사용하기 위하여 제안되었다   
  - 외부 해시 구조의 구현 예로 분류 자료를 다수의 부분으로 일부분을 이용하여 해싱한 후 나머지 분류 정보를 이용하여 트라이 구조로 색인을 하는 구조가 발표되었다

 
